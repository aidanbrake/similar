(function(){var previousInit=CanvasManipulation.prototype.init;CanvasManipulation.prototype.init=function(){previousInit.call(this,arguments);this.initTouchListeners()};
CanvasManipulation.prototype.initTouchListeners=function(){var b=this,a=Hammer(this.getCanvas(),{prevent_default:!0});a.on("dragstart",function(a){b.dragStart(b.touchCoord(a))});a.on("drag",function(a){b.drag(b.touchCoord(a))});a.on("dragend",function(){b.dragEnd()});this.isOldAndroid()||(a.on("pinchin",function(a){b.zoom(b.touchCoord(a),-1)}),a.on("pinchout",function(a){b.zoom(b.touchCoord(a),1)}),a.on("rotate",function(a){b.rotateHandler(b.touchCoord(a),a.gesture.rotation*Math.PI/180)}));a.on("release",
function(){b.release()})};CanvasManipulation.prototype.touchCoord=function(b){return{x:b.gesture.center.pageX,y:b.gesture.center.pageY}};CanvasManipulation.prototype.isOldAndroid=function(){return-1!==navigator.userAgent.toLowerCase().search("android [23]")};
CanvasManipulation.prototype.rotateHandler=function(b,a){if(this._isRotating||!(Math.abs(a)<Math.PI/18))this._isRotating=!0,isNaN(this._rotateStartAngle)?(this._rotateStartAngle=a,this.rotate(b,this._rotateStartAngle)):(this.rotate(b,a-this._rotateStartAngle),this._rotateStartAngle=a)};CanvasManipulation.prototype.release=function(){this.dragEnd();this._isRotating=!1;this._rotateStartAngle=null};}).call(this);